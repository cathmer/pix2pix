# pix2pix
Image to Image translation using PyTorch. 

## Training
To train the model, run `Train.py` with arguments. To start training:
```
python Train.py --use_cuda False --use_GAN True --is_conditional True --use_L1 True 
```
See help for specification of options. To restart training with partially trained model (assumes the model is stored in 
`storage/<folder>` and has names `<epoch_nr>_Dnet` and `<epoch_nr>_Gnet`):
```
python Train.py --use_cuda False --use_GAN True --is_conditional True --use_L1 True --restart True --model_path <folder>
```

To generate images from the validation set:
```
python Train.py --use_cuda False --generate True --epoch 200 --model_path <folder>
```

## Evaluation
First, the fcn-8s needs to be downloaded. Do this from the root, by running `./eval_cityscapes/download_fcn8s.sh`. 

Then, from the root folder, the following command can be run to do evaluation:
```
python ./eval_cityscapes/evaluate.py --cityscapes_dir ./dataset/cityscapes/resized_labels --result_dir ./dataset/cityscapes/original_images --output_dir ./dataset/cityscapes/evaluation_results
```

This will evaluate the original cityscape photos with resized labels. The original labels can also be used (change argument
of `--cityscape_dir` to `./dataset/cityscape/original_labels`). 

To resize labels to a different size (the bigger the labels, the better the evaluation, but also takes up more memory),
do the following:
```
cd dataset/cityscapes
# First, open resize_labels.sh and change the arguments to resize to use the wanted size
# Then, run resize_labels.sh. The resized_labels will be in resized_labels folder.
./resize_labels.sh
```

To run evaluation on different images (e.g. images generated by deep learning network), change argument of `--result_dir` to the 
directory that contains these images. These need to have the same names as the label images. 